<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ScriptML C API: resources/c/include/scriptml/i2c_regmap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ScriptML C API
   </div>
   <div id="projectbrief">Standard functionality available to C scripts</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0fc3f8f3ef96ce2d45d66d6e29832317.html">resources</a></li><li class="navelem"><a class="el" href="dir_db95e12360d2fad5bdee5a114f12bf10.html">c</a></li><li class="navelem"><a class="el" href="dir_f11e5616b781ad695c8a3ba0dc7db16e.html">include</a></li><li class="navelem"><a class="el" href="dir_6772998564a5962bb6b555f7f49995dc.html">scriptml</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">i2c_regmap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Sub-driver for I2C devices organised as regmaps.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="i2c_8h_source.html">scriptml/i2c.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="stdint_8h_source.html">stdint.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="stdlib_8h_source.html">stdlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="assert_8h_source.html">assert.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c_regmap.h:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__regmap_8h__incl.png" border="0" usemap="#resources_2c_2include_2scriptml_2i2c__regmap_8h" alt=""/></div>
<map name="resources_2c_2include_2scriptml_2i2c__regmap_8h" id="resources_2c_2include_2scriptml_2i2c__regmap_8h">
<area shape="rect" id="node2" href="i2c_8h.html" title="Generic I2C bus driver using /dev and ioctl. " alt="" coords="222,95,322,121"/>
<area shape="rect" id="node6" href="stdint_8h.html" title="Standard integer types. " alt="" coords="363,169,429,196"/>
<area shape="rect" id="node7" href="stdlib_8h.html" title="Standard library. " alt="" coords="27,169,91,196"/>
<area shape="rect" id="node9" href="string_8h.html" title="Standard string library. " alt="" coords="115,169,181,196"/>
<area shape="rect" id="node10" href="assert_8h.html" title="C Standard Library assertions. " alt="" coords="453,169,523,196"/>
<area shape="rect" id="node3" href="devsysfs_8h.html" title="Access to /dev and /sys nodes. " alt="" coords="204,169,340,196"/>
<area shape="rect" id="node4" href="unistd_8h.html" title="Miscellaneous C definitions. " alt="" coords="213,244,281,271"/>
<area shape="rect" id="node5" href="stddef_8h.html" title="Standard definitions. " alt="" coords="127,319,196,345"/>
<area shape="rect" id="node8" href="stdlib__math_8h.html" title="Standard library math functions. " alt="" coords="23,244,123,271"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__regmap_8h__dep__incl.png" border="0" usemap="#resources_2c_2include_2scriptml_2i2c__regmap_8hdep" alt=""/></div>
<map name="resources_2c_2include_2scriptml_2i2c__regmap_8hdep" id="resources_2c_2include_2scriptml_2i2c__regmap_8hdep">
<area shape="rect" id="node2" href="ad5627_8h.html" title="AD562 DAC device driver. " alt="" coords="5,95,140,136"/>
<area shape="rect" id="node3" href="ad7091_8h.html" title="Quad channel 12 bit ADC. " alt="" coords="164,95,299,136"/>
<area shape="rect" id="node4" href="isl29023_8h.html" title="ISL29023 device driver. " alt="" coords="323,95,457,136"/>
<area shape="rect" id="node5" href="lm75b_8h.html" title="LM75B device driver. " alt="" coords="481,95,616,136"/>
<area shape="rect" id="node6" href="mpl115a2_8h.html" title="Miniature I2C Digital Barometer. " alt="" coords="640,95,783,136"/>
<area shape="rect" id="node7" href="mpu6050_8h.html" title="MPU6050 device driver. " alt="" coords="807,95,947,136"/>
<area shape="rect" id="node8" href="pca9534_8h.html" title="GPIO Extender. " alt="" coords="971,95,1107,136"/>
<area shape="rect" id="node9" href="pca9685_8h.html" title="16&#45;channel, 12&#45;bit PWM Fm+ I2C&#45;bus LED Controller " alt="" coords="1131,95,1267,136"/>
<area shape="rect" id="node10" href="pcf8563_8h.html" title="Real&#45;time clock. " alt="" coords="1292,95,1427,136"/>
</map>
</div>
</div>
<p><a href="i2c__regmap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structsml__i2c__regmap__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a></td></tr>
<tr class="separator:structsml__i2c__regmap__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a506d81703ef13a5d99e7bd5d87a39109"><td class="memItemLeft" align="right" valign="top"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#a506d81703ef13a5d99e7bd5d87a39109">sml_i2c_regmap_create</a> (sml_i2c_t i2c, int addr, int size, int smbus_api)</td></tr>
<tr class="memdesc:a506d81703ef13a5d99e7bd5d87a39109"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create device driver instance.  <a href="#a506d81703ef13a5d99e7bd5d87a39109">More...</a><br /></td></tr>
<tr class="separator:a506d81703ef13a5d99e7bd5d87a39109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49296bb9669d947542cad3945742fef4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#a49296bb9669d947542cad3945742fef4">sml_i2c_regmap_write</a> (<a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev, const uint8_t *buf, uint8_t reg, <a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> count)</td></tr>
<tr class="memdesc:a49296bb9669d947542cad3945742fef4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write to I2C device registers.  <a href="#a49296bb9669d947542cad3945742fef4">More...</a><br /></td></tr>
<tr class="separator:a49296bb9669d947542cad3945742fef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6622b063561f738895ce5e09d9871ef4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#a6622b063561f738895ce5e09d9871ef4">sml_i2c_regmap_read</a> (<a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev, uint8_t *buf, uint8_t reg, <a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> count)</td></tr>
<tr class="memdesc:a6622b063561f738895ce5e09d9871ef4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read from I2C device registers.  <a href="#a6622b063561f738895ce5e09d9871ef4">More...</a><br /></td></tr>
<tr class="separator:a6622b063561f738895ce5e09d9871ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bf2e047f6f7a1e5bdd0c6a8430f26c"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">int_to_byte</a> (int *input_int, int num_bytes)</td></tr>
<tr class="memdesc:ac0bf2e047f6f7a1e5bdd0c6a8430f26c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an integer into a defined bumber of bytes.  <a href="#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">More...</a><br /></td></tr>
<tr class="separator:ac0bf2e047f6f7a1e5bdd0c6a8430f26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f738cc6902f2f6a12592ec574a06e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#a97f738cc6902f2f6a12592ec574a06e8">sml_i2c_regmap_writeL</a> (<a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev, const uint8_t *buf, int *reg, int reg_addr_size, <a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> count)</td></tr>
<tr class="memdesc:a97f738cc6902f2f6a12592ec574a06e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write long to I2C device registers for register addresses greater than one byte.  <a href="#a97f738cc6902f2f6a12592ec574a06e8">More...</a><br /></td></tr>
<tr class="separator:a97f738cc6902f2f6a12592ec574a06e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fec43f8152ea7162f7447bc1f073eca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#a4fec43f8152ea7162f7447bc1f073eca">sml_i2c_reg_write</a> (<a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev, const uint8_t *buf, <a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> count)</td></tr>
<tr class="memdesc:a4fec43f8152ea7162f7447bc1f073eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple write of a number of bytes to a single address (0x00)  <a href="#a4fec43f8152ea7162f7447bc1f073eca">More...</a><br /></td></tr>
<tr class="separator:a4fec43f8152ea7162f7447bc1f073eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e71466ff82f5b22b48b7d9bb1af413"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__regmap_8h.html#ab4e71466ff82f5b22b48b7d9bb1af413">sml_i2c_regmap_readL</a> (<a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev, uint8_t *buf, int *reg, int reg_addr_size, <a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> count)</td></tr>
<tr class="memdesc:ab4e71466ff82f5b22b48b7d9bb1af413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read long from I2C device registers for register addresses greater than one byte.  <a href="#ab4e71466ff82f5b22b48b7d9bb1af413">More...</a><br /></td></tr>
<tr class="separator:ab4e71466ff82f5b22b48b7d9bb1af413"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sub-driver for I2C devices organised as regmaps. </p>
<p>Where an I2C device implements a "regular" regmap, a <a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> instance may be created to permit access using straightforward read and write operations, simplifying device driver implementation.</p>
<p>The device must accept writes of the form START &lt;device addr+W bit&gt; &lt;register&gt; &lt;bytes...&gt; STOP</p>
<p>and reads of the form START &lt;device addr+W bit&gt; &lt;register&gt; START &lt;device addr+R bit&gt; &lt;bytes...&gt; STOP</p>
<p>Copyright (c) Open IO Labs Ltd 2016 All Rights Reserved </p>

<p>Definition in file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structsml__i2c__regmap__t" id="structsml__i2c__regmap__t"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sml_i2c_regmap_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00029">29</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="af9be2616dbff4c1f2e68fca1654bc28b"></a>sml_i2c_t *</td>
<td class="fieldname">
piic</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a7f08ecd47d6ca9d674c4738a1deb25f6"></a>int</td>
<td class="fieldname">
addr</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5ecb54a693cbb86b1f88f08a5d808c17"></a>int</td>
<td class="fieldname">
size</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ad91cae1a47f37dc526cb2d39d3f98b21"></a>int</td>
<td class="fieldname">
smbus_api</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a506d81703ef13a5d99e7bd5d87a39109"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> sml_i2c_regmap_create </td>
          <td>(</td>
          <td class="paramtype">sml_i2c_t&#160;</td>
          <td class="paramname"><em>i2c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smbus_api</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create device driver instance. </p>
<p>Note that the I2C/SMBUS API can only be used with devices that auto-increment the register number on multi-byte operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2c</td><td>An instance of the I2C driver for the bus on which the device is placed </td></tr>
    <tr><td class="paramname">addr</td><td>Address of the I2C device on the bus </td></tr>
    <tr><td class="paramname">size</td><td>Number of registers in the regmap (just for a check) </td></tr>
    <tr><td class="paramname">smbus_api</td><td>0 for plain I2C; 1 for I2C/SMBUS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Device handle </dd></dl>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00049">49</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>Referenced by <a class="el" href="ad7091_8h_source.html#l00076">sml_ad7091_create()</a>, <a class="el" href="isl29023_8h_source.html#l00057">sml_isl29023_create()</a>, <a class="el" href="lm75b_8h_source.html#l00049">sml_lm75b_create()</a>, <a class="el" href="mpl115a2_8h_source.html#l00034">sml_mpl115a2_create()</a>, <a class="el" href="mpu6050_8h_source.html#l00078">sml_mpu6050_create()</a>, <a class="el" href="pca9534_8h_source.html#l00040">sml_pca9534_create()</a>, <a class="el" href="pca9685_8h_source.html#l00053">sml_pca9685_create()</a>, and <a class="el" href="pcf8563_8h_source.html#l00064">sml_pcf8563_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a> dev;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    dev.piic = &amp;i2c;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    dev.addr = addr;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    dev.size = size;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    dev.smbus_api = smbus_api;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> dev;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="i2c__regmap_8h_html_structsml__i2c__regmap__t"><div class="ttname"><a href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c__regmap_8h_source.html#l00029">i2c_regmap.h:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49296bb9669d947542cad3945742fef4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sml_i2c_regmap_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write to I2C device registers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device handle </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data to write </td></tr>
    <tr><td class="paramname">reg</td><td>Number of first register to write </td></tr>
    <tr><td class="paramname">count</td><td>Number of bytes to write</td></tr>
  </table>
  </dd>
</dl>
<p>If count is greater than one, multiple bytes are written stating at reg. Count must be at least one byte and the write operation must not go past the end of the register map. Note that it is dependent on the device whether a multiple write goes to sucessive registers. </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00072">72</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00034">assert</a>, <a class="el" href="i2c_8h_source.html#l00050">i2c_msg::buf</a>, <a class="el" href="i2c_8h_source.html#l00048">i2c_msg::flags</a>, <a class="el" href="i2c_8h_source.html#l00049">i2c_msg::len</a>, <a class="el" href="stdlib_8h_source.html#l00050">malloc()</a>, <a class="el" href="string_8h_source.html#l00334">memcpy()</a>, <a class="el" href="stdio_8h_source.html#l00236">printf()</a>, <a class="el" href="i2c_8h_source.html#l00197">sml_i2c_smbus_set_addr()</a>, <a class="el" href="i2c_8h_source.html#l00319">sml_i2c_smbus_write_byte_data()</a>, and <a class="el" href="i2c_8h_source.html#l00110">sml_i2c_transfer()</a>.</p>

<p>Referenced by <a class="el" href="ad7091_8h_source.html#l00234">sml_ad7091_set_ch0_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00261">sml_ad7091_set_ch0_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00207">sml_ad7091_set_ch0_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00315">sml_ad7091_set_ch1_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00342">sml_ad7091_set_ch1_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00288">sml_ad7091_set_ch1_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00396">sml_ad7091_set_ch2_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00423">sml_ad7091_set_ch2_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00369">sml_ad7091_set_ch2_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00477">sml_ad7091_set_ch3_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00504">sml_ad7091_set_ch3_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00450">sml_ad7091_set_ch3_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00111">sml_ad7091_set_channel_register()</a>, <a class="el" href="ad7091_8h_source.html#l00154">sml_ad7091_set_conf_reg()</a>, <a class="el" href="isl29023_8h_source.html#l00072">sml_isl29023_set_command_1()</a>, <a class="el" href="isl29023_8h_source.html#l00086">sml_isl29023_set_command_2()</a>, <a class="el" href="isl29023_8h_source.html#l00126">sml_isl29023_set_int_ht()</a>, <a class="el" href="isl29023_8h_source.html#l00112">sml_isl29023_set_int_lt()</a>, <a class="el" href="lm75b_8h_source.html#l00066">sml_lm75b_set_conf()</a>, <a class="el" href="lm75b_8h_source.html#l00106">sml_lm75b_set_thyst()</a>, <a class="el" href="lm75b_8h_source.html#l00092">sml_lm75b_set_tos()</a>, <a class="el" href="mpl115a2_8h_source.html#l00128">sml_mpl115a2_convert()</a>, <a class="el" href="mpu6050_8h_source.html#l00143">sml_mpu6050_set_accel_config()</a>, <a class="el" href="mpu6050_8h_source.html#l00117">sml_mpu6050_set_config()</a>, <a class="el" href="mpu6050_8h_source.html#l00163">sml_mpu6050_set_fifo_en()</a>, <a class="el" href="mpu6050_8h_source.html#l00400">sml_mpu6050_set_fifo_r_w()</a>, <a class="el" href="mpu6050_8h_source.html#l00130">sml_mpu6050_set_gyro_config()</a>, <a class="el" href="mpu6050_8h_source.html#l00197">sml_mpu6050_set_int_enable()</a>, <a class="el" href="mpu6050_8h_source.html#l00182">sml_mpu6050_set_int_pin_cfg()</a>, <a class="el" href="mpu6050_8h_source.html#l00355">sml_mpu6050_set_pwr_mgmt_1()</a>, <a class="el" href="mpu6050_8h_source.html#l00374">sml_mpu6050_set_pwr_mgmt_2()</a>, <a class="el" href="mpu6050_8h_source.html#l00320">sml_mpu6050_set_signal_path_reset()</a>, <a class="el" href="mpu6050_8h_source.html#l00092">sml_mpu6050_set_smprt_div()</a>, <a class="el" href="mpu6050_8h_source.html#l00338">sml_mpu6050_set_user_ctrl()</a>, <a class="el" href="pca9534_8h_source.html#l00115">sml_pca9534_set_configuration()</a>, <a class="el" href="pca9534_8h_source.html#l00067">sml_pca9534_set_output()</a>, <a class="el" href="pca9534_8h_source.html#l00091">sml_pca9534_set_polarity()</a>, <a class="el" href="pca9685_8h_source.html#l00166">sml_pca9685_set_all_led_on_off()</a>, <a class="el" href="pca9685_8h_source.html#l00145">sml_pca9685_set_led_on_off()</a>, <a class="el" href="pca9685_8h_source.html#l00073">sml_pca9685_set_mode1()</a>, <a class="el" href="pca9685_8h_source.html#l00116">sml_pca9685_set_mode2()</a>, <a class="el" href="pca9685_8h_source.html#l00184">sml_pca9685_set_pre_scale()</a>, <a class="el" href="pca9685_8h_source.html#l00130">sml_pca9685_set_subadr()</a>, <a class="el" href="pcf8563_8h_source.html#l00342">sml_pcf8563_set_clkout_control()</a>, <a class="el" href="pcf8563_8h_source.html#l00078">sml_pcf8563_set_control_status_1()</a>, <a class="el" href="pcf8563_8h_source.html#l00108">sml_pcf8563_set_control_status_2()</a>, <a class="el" href="pcf8563_8h_source.html#l00282">sml_pcf8563_set_day_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00250">sml_pcf8563_set_hour_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00218">sml_pcf8563_set_minute_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00399">sml_pcf8563_set_timer()</a>, <a class="el" href="pcf8563_8h_source.html#l00371">sml_pcf8563_set_timer_control()</a>, <a class="el" href="pcf8563_8h_source.html#l00156">sml_pcf8563_set_vl_and_time_combined()</a>, and <a class="el" href="pcf8563_8h_source.html#l00313">sml_pcf8563_set_weekday_alarm()</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( count &gt;= 1 );</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( reg &lt; dev.size );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#ifdef TRACE_I2C_REGMAP</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;I2C at 0x%x regmap at 0x%x write&quot;</span>, dev.addr, reg);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">for</span>( i=0; i&lt;(int)count; i++ )</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot; 0x%x&quot;</span>, buf[i] );</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span>( dev.smbus_api )</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="i2c_8h.html#a5c0a7d8e84f05f736d9b40b9967bc73b">sml_i2c_smbus_set_addr</a>( *(dev.piic), dev.addr );</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">for</span>( i=0; i&lt;count; i++ )</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="i2c_8h.html#aefe0c457ded8ce46ca120f067d57ce64">sml_i2c_smbus_write_byte_data</a>( *(dev.piic), reg+i, buf[i] );</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        uint8_t *wbuf = (uint8_t *)<a class="code" href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a>( count+1 );</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        wbuf[0] = (uint8_t)reg;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="string_8h.html#abb6648d2c8dcebe0fbd21f349c5314dc">memcpy</a>( wbuf+1, buf, count );</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">struct </span><a class="code" href="i2c_8h.html#structi2c__msg">i2c_msg</a> msg[1];  </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        msg[0].addr = dev.addr;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        msg[0].flags = 0; <span class="comment">// Write</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        msg[0].buf = wbuf;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        msg[0].len = count + 1; <span class="comment">// Account for the register byte</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a>(*(dev.piic), msg, 1);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="ttc" id="i2c_8h_html_a949d796c65704e683aba115ccac18a8b"><div class="ttname"><a href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a></div><div class="ttdeci">void sml_i2c_transfer(sml_i2c_t dev, struct i2c_msg *msgs, int num)</div><div class="ttdoc">Perform I2C transfer(s) </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00110">i2c.h:110</a></div></div>
<div class="ttc" id="assert_8h_html_a1ebed30aae3ede0b583728b4c447d3ad"><div class="ttname"><a href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a></div><div class="ttdeci">#define assert(COND)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00034">assert.h:34</a></div></div>
<div class="ttc" id="i2c_8h_html_a5c0a7d8e84f05f736d9b40b9967bc73b"><div class="ttname"><a href="i2c_8h.html#a5c0a7d8e84f05f736d9b40b9967bc73b">sml_i2c_smbus_set_addr</a></div><div class="ttdeci">void sml_i2c_smbus_set_addr(sml_i2c_t dev, uint8_t addr)</div><div class="ttdoc">Set I2C bus device address. </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00197">i2c.h:197</a></div></div>
<div class="ttc" id="stdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div><div class="ttdoc">Formatted print to stdout. </div><div class="ttdef"><b>Definition:</b> <a href="stdio_8h_source.html#l00236">stdio.h:236</a></div></div>
<div class="ttc" id="stdlib_8h_html_a7ac38fce3243a7dcf448301ee9ffd392"><div class="ttname"><a href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a></div><div class="ttdeci">void * malloc(size_t size)</div><div class="ttdoc">Allocate an array of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="stdlib_8h_source.html#l00050">stdlib.h:50</a></div></div>
<div class="ttc" id="i2c_8h_html_structi2c__msg"><div class="ttname"><a href="i2c_8h.html#structi2c__msg">i2c_msg</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00046">i2c.h:46</a></div></div>
<div class="ttc" id="i2c_8h_html_aefe0c457ded8ce46ca120f067d57ce64"><div class="ttname"><a href="i2c_8h.html#aefe0c457ded8ce46ca120f067d57ce64">sml_i2c_smbus_write_byte_data</a></div><div class="ttdeci">void sml_i2c_smbus_write_byte_data(sml_i2c_t dev, uint8_t command, uint8_t value)</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00319">i2c.h:319</a></div></div>
<div class="ttc" id="string_8h_html_abb6648d2c8dcebe0fbd21f349c5314dc"><div class="ttname"><a href="string_8h.html#abb6648d2c8dcebe0fbd21f349c5314dc">memcpy</a></div><div class="ttdeci">char * memcpy(char *dest, const char *src, size_t n)</div><div class="ttdoc">Copy memory. </div><div class="ttdef"><b>Definition:</b> <a href="string_8h_source.html#l00334">string.h:334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6622b063561f738895ce5e09d9871ef4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sml_i2c_regmap_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read from I2C device registers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device handle </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data for read </td></tr>
    <tr><td class="paramname">reg</td><td>Number of first register to read </td></tr>
    <tr><td class="paramname">count</td><td>Number of bytes to read</td></tr>
  </table>
  </dd>
</dl>
<p>If count is greater than one, multiple bytes are read stating at reg. Count must be at least one byte and the write operation must not go past the end of the register map. Note that it is dependent on the device whether a multiple read reads sucessive registers. </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00123">123</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00034">assert</a>, <a class="el" href="i2c_8h_source.html#l00050">i2c_msg::buf</a>, <a class="el" href="i2c_8h_source.html#l00048">i2c_msg::flags</a>, <a class="el" href="i2c_8h_source.html#l00049">i2c_msg::len</a>, <a class="el" href="stdio_8h_source.html#l00236">printf()</a>, <a class="el" href="i2c_8h_source.html#l00296">sml_i2c_smbus_read_byte_data()</a>, <a class="el" href="i2c_8h_source.html#l00197">sml_i2c_smbus_set_addr()</a>, and <a class="el" href="i2c_8h_source.html#l00110">sml_i2c_transfer()</a>.</p>

<p>Referenced by <a class="el" href="ad7091_8h_source.html#l00248">sml_ad7091_get_ch0_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00275">sml_ad7091_get_ch0_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00221">sml_ad7091_get_ch0_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00329">sml_ad7091_get_ch1_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00356">sml_ad7091_get_ch1_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00302">sml_ad7091_get_ch1_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00410">sml_ad7091_get_ch2_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00437">sml_ad7091_get_ch2_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00383">sml_ad7091_get_ch2_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00491">sml_ad7091_get_ch3_high_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00518">sml_ad7091_get_ch3_hyst_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00464">sml_ad7091_get_ch3_low_limit()</a>, <a class="el" href="ad7091_8h_source.html#l00127">sml_ad7091_get_channel_register()</a>, <a class="el" href="ad7091_8h_source.html#l00181">sml_ad7091_get_conf_reg()</a>, <a class="el" href="ad7091_8h_source.html#l00091">sml_ad7091_get_conv_res()</a>, <a class="el" href="isl29023_8h_source.html#l00099">sml_isl29023_get_data()</a>, <a class="el" href="lm75b_8h_source.html#l00079">sml_lm75b_get_temp()</a>, <a class="el" href="mpl115a2_8h_source.html#l00077">sml_mpl115a2_get_a0()</a>, <a class="el" href="mpl115a2_8h_source.html#l00090">sml_mpl115a2_get_b1()</a>, <a class="el" href="mpl115a2_8h_source.html#l00103">sml_mpl115a2_get_b2()</a>, <a class="el" href="mpl115a2_8h_source.html#l00116">sml_mpl115a2_get_c12()</a>, <a class="el" href="mpl115a2_8h_source.html#l00047">sml_mpl115a2_get_padc()</a>, <a class="el" href="mpl115a2_8h_source.html#l00062">sml_mpl115a2_get_tadc()</a>, <a class="el" href="mpu6050_8h_source.html#l00227">sml_mpu6050_get_accel_xout()</a>, <a class="el" href="mpu6050_8h_source.html#l00240">sml_mpu6050_get_accel_yout()</a>, <a class="el" href="mpu6050_8h_source.html#l00253">sml_mpu6050_get_accel_zout()</a>, <a class="el" href="mpu6050_8h_source.html#l00387">sml_mpu6050_get_fifo_count()</a>, <a class="el" href="mpu6050_8h_source.html#l00411">sml_mpu6050_get_fifo_r_w()</a>, <a class="el" href="mpu6050_8h_source.html#l00279">sml_mpu6050_get_gyro_xout()</a>, <a class="el" href="mpu6050_8h_source.html#l00292">sml_mpu6050_get_gyro_yout()</a>, <a class="el" href="mpu6050_8h_source.html#l00305">sml_mpu6050_get_gyro_zout()</a>, <a class="el" href="mpu6050_8h_source.html#l00212">sml_mpu6050_get_int_status()</a>, <a class="el" href="mpu6050_8h_source.html#l00103">sml_mpu6050_get_smprt_div()</a>, <a class="el" href="mpu6050_8h_source.html#l00266">sml_mpu6050_get_temp_out()</a>, <a class="el" href="mpu6050_8h_source.html#l00424">sml_mpu6050_get_who_am_i()</a>, <a class="el" href="pca9534_8h_source.html#l00126">sml_pca9534_get_configuration()</a>, <a class="el" href="pca9534_8h_source.html#l00054">sml_pca9534_get_input()</a>, <a class="el" href="pca9534_8h_source.html#l00078">sml_pca9534_get_output()</a>, <a class="el" href="pca9534_8h_source.html#l00102">sml_pca9534_get_polarity()</a>, <a class="el" href="pca9685_8h_source.html#l00093">sml_pca9685_get_mode1()</a>, <a class="el" href="pcf8563_8h_source.html#l00356">sml_pcf8563_get_clkout_control()</a>, <a class="el" href="pcf8563_8h_source.html#l00091">sml_pcf8563_get_control_status_1()</a>, <a class="el" href="pcf8563_8h_source.html#l00125">sml_pcf8563_get_control_status_2()</a>, <a class="el" href="pcf8563_8h_source.html#l00297">sml_pcf8563_get_day_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00265">sml_pcf8563_get_hour_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00233">sml_pcf8563_get_minute_alarm()</a>, <a class="el" href="pcf8563_8h_source.html#l00410">sml_pcf8563_get_timer()</a>, <a class="el" href="pcf8563_8h_source.html#l00385">sml_pcf8563_get_timer_control()</a>, <a class="el" href="pcf8563_8h_source.html#l00189">sml_pcf8563_get_vl_and_time_combined()</a>, and <a class="el" href="pcf8563_8h_source.html#l00327">sml_pcf8563_get_weekday_alarm()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( count &gt;= 1 );</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( reg &lt; dev.size );</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span>( dev.smbus_api )</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="i2c_8h.html#a5c0a7d8e84f05f736d9b40b9967bc73b">sml_i2c_smbus_set_addr</a>( *(dev.piic), dev.addr );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span>( i=0; i&lt;count; i++ )</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>[i] = <a class="code" href="i2c_8h.html#a129e93458d68c6e30f760e29ad08ece1">sml_i2c_smbus_read_byte_data</a>( *(dev.piic), reg+i );     </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">struct </span><a class="code" href="i2c_8h.html#structi2c__msg">i2c_msg</a> msg[2];  </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        </div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        msg[0].addr = dev.addr;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        msg[0].flags = 0; <span class="comment">// Write</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        msg[0].buf = &amp;reg;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        msg[0].len = 1;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        msg[1].addr = dev.addr;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        msg[1].flags = I2C_M_RD; <span class="comment">// Read</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        msg[1].buf = <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        msg[1].len = count;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a>(*(dev.piic), msg, 2);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef TRACE_I2C_REGMAP</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;I2C at 0x%x regmap at 0x%x read&quot;</span>, dev.addr, reg);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">for</span>( i=0; i&lt;(int)count; i++ )</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot; 0x%x&quot;</span>, <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>[i] );</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="ttc" id="i2c_8h_html_a949d796c65704e683aba115ccac18a8b"><div class="ttname"><a href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a></div><div class="ttdeci">void sml_i2c_transfer(sml_i2c_t dev, struct i2c_msg *msgs, int num)</div><div class="ttdoc">Perform I2C transfer(s) </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00110">i2c.h:110</a></div></div>
<div class="ttc" id="assert_8h_html_a1ebed30aae3ede0b583728b4c447d3ad"><div class="ttname"><a href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a></div><div class="ttdeci">#define assert(COND)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00034">assert.h:34</a></div></div>
<div class="ttc" id="i2c_8h_html_a5c0a7d8e84f05f736d9b40b9967bc73b"><div class="ttname"><a href="i2c_8h.html#a5c0a7d8e84f05f736d9b40b9967bc73b">sml_i2c_smbus_set_addr</a></div><div class="ttdeci">void sml_i2c_smbus_set_addr(sml_i2c_t dev, uint8_t addr)</div><div class="ttdoc">Set I2C bus device address. </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00197">i2c.h:197</a></div></div>
<div class="ttc" id="stdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div><div class="ttdoc">Formatted print to stdout. </div><div class="ttdef"><b>Definition:</b> <a href="stdio_8h_source.html#l00236">stdio.h:236</a></div></div>
<div class="ttc" id="i2c_8h_html_ac4aa590487270589a51964b38f853a37"><div class="ttname"><a href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">i2c_msg::buf</a></div><div class="ttdeci">uint8_t * buf</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00050">i2c.h:50</a></div></div>
<div class="ttc" id="i2c_8h_html_structi2c__msg"><div class="ttname"><a href="i2c_8h.html#structi2c__msg">i2c_msg</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00046">i2c.h:46</a></div></div>
<div class="ttc" id="i2c_8h_html_a129e93458d68c6e30f760e29ad08ece1"><div class="ttname"><a href="i2c_8h.html#a129e93458d68c6e30f760e29ad08ece1">sml_i2c_smbus_read_byte_data</a></div><div class="ttdeci">uint8_t sml_i2c_smbus_read_byte_data(sml_i2c_t dev, uint8_t command)</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00296">i2c.h:296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0bf2e047f6f7a1e5bdd0c6a8430f26c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* int_to_byte </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>input_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an integer into a defined bumber of bytes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_int</td><td>Input integer to convert </td></tr>
    <tr><td class="paramname">num_bytes</td><td>Number of bytes to extract from the integer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A byte array with num_bytes elements </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">count</td><td>Number of bytes to read</td></tr>
  </table>
  </dd>
</dl>
<p>The endian-ness of this operations is as follows; The MSB is returned in the lowest index [0] and the LSB in the highest index [num_bytes - 1] </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00172">172</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="stdlib_8h_source.html#l00050">malloc()</a>.</p>

<p>Referenced by <a class="el" href="i2c__regmap_8h_source.html#l00262">sml_i2c_regmap_readL()</a>, and <a class="el" href="i2c__regmap_8h_source.html#l00195">sml_i2c_regmap_writeL()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                     {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    uint8_t * ret_bytes = <a class="code" href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a>(num_bytes * 8);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num_bytes; i++){</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        ret_bytes[i] = (* input_int) &gt;&gt; (((num_bytes-1)-i) * 8);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> ret_bytes;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div><div class="ttc" id="stdlib_8h_html_a7ac38fce3243a7dcf448301ee9ffd392"><div class="ttname"><a href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a></div><div class="ttdeci">void * malloc(size_t size)</div><div class="ttdoc">Allocate an array of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="stdlib_8h_source.html#l00050">stdlib.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97f738cc6902f2f6a12592ec574a06e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sml_i2c_regmap_writeL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reg_addr_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write long to I2C device registers for register addresses greater than one byte. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device handle </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data to write </td></tr>
    <tr><td class="paramname">reg</td><td>Number of first register to write </td></tr>
    <tr><td class="paramname">reg_addr_size</td><td>Register address size in bytes, maximum is 4 bytes </td></tr>
    <tr><td class="paramname">count</td><td>Number of bytes to write</td></tr>
  </table>
  </dd>
</dl>
<p>If count is greater than one, contiguous registers are written stating at reg. Count must be at least one byte and the write operation must not go past the end of the register map. </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00195">195</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00034">assert</a>, <a class="el" href="i2c_8h_source.html#l00050">i2c_msg::buf</a>, <a class="el" href="i2c_8h_source.html#l00048">i2c_msg::flags</a>, <a class="el" href="i2c__regmap_8h_source.html#l00172">int_to_byte()</a>, <a class="el" href="i2c_8h_source.html#l00049">i2c_msg::len</a>, <a class="el" href="stdlib_8h_source.html#l00050">malloc()</a>, <a class="el" href="string_8h_source.html#l00334">memcpy()</a>, <a class="el" href="stdio_8h_source.html#l00236">printf()</a>, and <a class="el" href="i2c_8h_source.html#l00110">sml_i2c_transfer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( count &gt;= 1 );</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( *reg + count &lt;= dev.size );</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef TRACE_I2C_REGMAP</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">for</span>( i=0; i&lt;(int)count; i++ )</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot; 0x%x&quot;</span>, <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>[i] );</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    uint8_t *wbuf = (uint8_t *)<a class="code" href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a>( count + reg_addr_size );</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    uint8_t *raddr = (uint8_t *)<a class="code" href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a>( reg_addr_size );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    raddr = <a class="code" href="i2c__regmap_8h.html#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">int_to_byte</a>(reg, reg_addr_size);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; reg_addr_size; i++){</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        wbuf[i]  = raddr[i];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="string_8h.html#abb6648d2c8dcebe0fbd21f349c5314dc">memcpy</a>( wbuf+reg_addr_size, <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>, count );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">struct </span><a class="code" href="i2c_8h.html#structi2c__msg">i2c_msg</a> msg[1];  </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    msg[0].addr = (dev.addr);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    msg[0].flags = 0; <span class="comment">// Write</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    msg[0].buf = wbuf;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    msg[0].len = count;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a>(*(dev.piic), msg, 1);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="ttc" id="i2c__regmap_8h_html_ac0bf2e047f6f7a1e5bdd0c6a8430f26c"><div class="ttname"><a href="i2c__regmap_8h.html#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">int_to_byte</a></div><div class="ttdeci">uint8_t * int_to_byte(int *input_int, int num_bytes)</div><div class="ttdoc">Convert an integer into a defined bumber of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="i2c__regmap_8h_source.html#l00172">i2c_regmap.h:172</a></div></div>
<div class="ttc" id="i2c_8h_html_a949d796c65704e683aba115ccac18a8b"><div class="ttname"><a href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a></div><div class="ttdeci">void sml_i2c_transfer(sml_i2c_t dev, struct i2c_msg *msgs, int num)</div><div class="ttdoc">Perform I2C transfer(s) </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00110">i2c.h:110</a></div></div>
<div class="ttc" id="assert_8h_html_a1ebed30aae3ede0b583728b4c447d3ad"><div class="ttname"><a href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a></div><div class="ttdeci">#define assert(COND)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00034">assert.h:34</a></div></div>
<div class="ttc" id="stdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div><div class="ttdoc">Formatted print to stdout. </div><div class="ttdef"><b>Definition:</b> <a href="stdio_8h_source.html#l00236">stdio.h:236</a></div></div>
<div class="ttc" id="i2c_8h_html_ac4aa590487270589a51964b38f853a37"><div class="ttname"><a href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">i2c_msg::buf</a></div><div class="ttdeci">uint8_t * buf</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00050">i2c.h:50</a></div></div>
<div class="ttc" id="stdlib_8h_html_a7ac38fce3243a7dcf448301ee9ffd392"><div class="ttname"><a href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a></div><div class="ttdeci">void * malloc(size_t size)</div><div class="ttdoc">Allocate an array of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="stdlib_8h_source.html#l00050">stdlib.h:50</a></div></div>
<div class="ttc" id="i2c_8h_html_structi2c__msg"><div class="ttname"><a href="i2c_8h.html#structi2c__msg">i2c_msg</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00046">i2c.h:46</a></div></div>
<div class="ttc" id="string_8h_html_abb6648d2c8dcebe0fbd21f349c5314dc"><div class="ttname"><a href="string_8h.html#abb6648d2c8dcebe0fbd21f349c5314dc">memcpy</a></div><div class="ttdeci">char * memcpy(char *dest, const char *src, size_t n)</div><div class="ttdoc">Copy memory. </div><div class="ttdef"><b>Definition:</b> <a href="string_8h_source.html#l00334">string.h:334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4fec43f8152ea7162f7447bc1f073eca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sml_i2c_reg_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple write of a number of bytes to a single address (0x00) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device handle </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data to write </td></tr>
    <tr><td class="paramname">count</td><td>Number of bytes to write</td></tr>
  </table>
  </dd>
</dl>
<p>If count is greater than one, contiguous registers are written stating at reg. Count must be at least one byte and the write operation must not go past the end of the register map. </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00238">238</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="i2c_8h_source.html#l00050">i2c_msg::buf</a>, <a class="el" href="i2c_8h_source.html#l00048">i2c_msg::flags</a>, <a class="el" href="i2c_8h_source.html#l00049">i2c_msg::len</a>, and <a class="el" href="i2c_8h_source.html#l00110">sml_i2c_transfer()</a>.</p>

<p>Referenced by <a class="el" href="ad5627_8h_source.html#l00067">sml_ad5627_power()</a>, <a class="el" href="ad5627_8h_source.html#l00052">sml_ad5627_reset()</a>, <a class="el" href="ad5627_8h_source.html#l00082">sml_ad5627_set_ldac()</a>, and <a class="el" href="ad5627_8h_source.html#l00037">sml_ad5627_set_level()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{   </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">struct </span><a class="code" href="i2c_8h.html#structi2c__msg">i2c_msg</a> msg[1];  </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    msg[0].addr = (dev.addr);   </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    msg[0].flags = 0; <span class="comment">// Write</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    msg[0].buf = <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    msg[0].len = count;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a>(*(dev.piic), msg, 1);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div><div class="ttc" id="i2c_8h_html_a949d796c65704e683aba115ccac18a8b"><div class="ttname"><a href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a></div><div class="ttdeci">void sml_i2c_transfer(sml_i2c_t dev, struct i2c_msg *msgs, int num)</div><div class="ttdoc">Perform I2C transfer(s) </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00110">i2c.h:110</a></div></div>
<div class="ttc" id="i2c_8h_html_ac4aa590487270589a51964b38f853a37"><div class="ttname"><a href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">i2c_msg::buf</a></div><div class="ttdeci">uint8_t * buf</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00050">i2c.h:50</a></div></div>
<div class="ttc" id="i2c_8h_html_structi2c__msg"><div class="ttname"><a href="i2c_8h.html#structi2c__msg">i2c_msg</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00046">i2c.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab4e71466ff82f5b22b48b7d9bb1af413"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sml_i2c_regmap_readL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c__regmap_8h.html#structsml__i2c__regmap__t">sml_i2c_regmap_t</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reg_addr_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stddef_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read long from I2C device registers for register addresses greater than one byte. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device handle </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data for read </td></tr>
    <tr><td class="paramname">reg</td><td>Number of first register to read </td></tr>
    <tr><td class="paramname">count</td><td>Number of bytes to read</td></tr>
  </table>
  </dd>
</dl>
<p>If count is greater than one, contiguous registers are written stating at reg. Count must be at least one byte and the write operation must not go past the end of the register map. </p>

<p>Definition at line <a class="el" href="i2c__regmap_8h_source.html#l00262">262</a> of file <a class="el" href="i2c__regmap_8h_source.html">i2c_regmap.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00034">assert</a>, <a class="el" href="i2c_8h_source.html#l00050">i2c_msg::buf</a>, <a class="el" href="i2c_8h_source.html#l00048">i2c_msg::flags</a>, <a class="el" href="i2c__regmap_8h_source.html#l00172">int_to_byte()</a>, <a class="el" href="i2c_8h_source.html#l00049">i2c_msg::len</a>, <a class="el" href="stdlib_8h_source.html#l00050">malloc()</a>, <a class="el" href="stdio_8h_source.html#l00236">printf()</a>, and <a class="el" href="i2c_8h_source.html#l00110">sml_i2c_transfer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( count &gt;= 1 );</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a>( *reg + count &lt;= dev.size );</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">struct </span><a class="code" href="i2c_8h.html#structi2c__msg">i2c_msg</a> msg[2];  </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    uint8_t *raddr = (uint8_t *)<a class="code" href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a>( reg_addr_size );</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    raddr = <a class="code" href="i2c__regmap_8h.html#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">int_to_byte</a>(reg, reg_addr_size);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    </div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    msg[0].addr = (dev.addr);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    msg[0].flags = 0; <span class="comment">// Write</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    msg[0].buf = raddr;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    msg[0].len = reg_addr_size;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    msg[1].addr = (dev.addr);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    msg[1].flags = I2C_M_RD; <span class="comment">// Read</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    msg[1].buf = <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    msg[1].len = count;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a>(*(dev.piic), msg, 2);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#ifdef TRACE_I2C_REGMAP</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span>( i=0; i&lt;(int)count; i++ )</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot; 0x%x&quot;</span>, <a class="code" href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">buf</a>[i] );</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="ttc" id="i2c__regmap_8h_html_ac0bf2e047f6f7a1e5bdd0c6a8430f26c"><div class="ttname"><a href="i2c__regmap_8h.html#ac0bf2e047f6f7a1e5bdd0c6a8430f26c">int_to_byte</a></div><div class="ttdeci">uint8_t * int_to_byte(int *input_int, int num_bytes)</div><div class="ttdoc">Convert an integer into a defined bumber of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="i2c__regmap_8h_source.html#l00172">i2c_regmap.h:172</a></div></div>
<div class="ttc" id="i2c_8h_html_a949d796c65704e683aba115ccac18a8b"><div class="ttname"><a href="i2c_8h.html#a949d796c65704e683aba115ccac18a8b">sml_i2c_transfer</a></div><div class="ttdeci">void sml_i2c_transfer(sml_i2c_t dev, struct i2c_msg *msgs, int num)</div><div class="ttdoc">Perform I2C transfer(s) </div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00110">i2c.h:110</a></div></div>
<div class="ttc" id="assert_8h_html_a1ebed30aae3ede0b583728b4c447d3ad"><div class="ttname"><a href="assert_8h.html#a1ebed30aae3ede0b583728b4c447d3ad">assert</a></div><div class="ttdeci">#define assert(COND)</div><div class="ttdef"><b>Definition:</b> <a href="assert_8h_source.html#l00034">assert.h:34</a></div></div>
<div class="ttc" id="stdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div><div class="ttdoc">Formatted print to stdout. </div><div class="ttdef"><b>Definition:</b> <a href="stdio_8h_source.html#l00236">stdio.h:236</a></div></div>
<div class="ttc" id="i2c_8h_html_ac4aa590487270589a51964b38f853a37"><div class="ttname"><a href="i2c_8h.html#ac4aa590487270589a51964b38f853a37">i2c_msg::buf</a></div><div class="ttdeci">uint8_t * buf</div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00050">i2c.h:50</a></div></div>
<div class="ttc" id="stdlib_8h_html_a7ac38fce3243a7dcf448301ee9ffd392"><div class="ttname"><a href="stdlib_8h.html#a7ac38fce3243a7dcf448301ee9ffd392">malloc</a></div><div class="ttdeci">void * malloc(size_t size)</div><div class="ttdoc">Allocate an array of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="stdlib_8h_source.html#l00050">stdlib.h:50</a></div></div>
<div class="ttc" id="i2c_8h_html_structi2c__msg"><div class="ttname"><a href="i2c_8h.html#structi2c__msg">i2c_msg</a></div><div class="ttdef"><b>Definition:</b> <a href="i2c_8h_source.html#l00046">i2c.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Oct 29 2017 01:27:21 for ScriptML C API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
